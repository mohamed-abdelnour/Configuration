#!/usr/bin/env dash

choose_session() {
    printf '%s\n' "$last_session" "$sessions" |
        fzf +m --no-color --prompt 'Session: ' --reverse
}

clear
cd "$HOME/.config/xinit" || exit 0
last_session="$(cat last-session.txt)"
sessions="$(sed /"$last_session"/d sessions.txt)"
this_session="$(choose_session)"
if [ -n "$this_session" ]; then
    sed "s/INIT/${this_session}_init/g" "skeletonrc" \
        > "$HOME/.xinitrc"
    printf '%s\n' "$this_session" > "last-session.txt"
fi
clear
exit 0
